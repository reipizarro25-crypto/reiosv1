<!DOCTYPE html>
<html>
<head>
<title>Retro Pixel OS</title>
<style>
body {
  margin:0; font-family:monospace;
  background:black; color:#00ff00;
  overflow:hidden;
}
.boot-screen {
  width:100vw;height:100vh;
  background:black;color:#00ff00;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  font-size:22px;text-align:center;
}
.boot-btn {
  margin:8px;padding:10px 20px;
  border:2px solid #00ff00;cursor:pointer;
  background:black;color:#00ff00;font-size:20px;
}
#desktop {
  width:100vw;height:100vh;display:none;
}
.taskbar {
  position:absolute;bottom:0;left:0;width:100%;
  background:black;border-top:2px solid currentColor;
  padding:4px;display:flex;align-items:center;gap:6px;
}
.window {
  position:absolute;background:#000;
  border:2px solid currentColor;padding:4px;
  min-width:180px;min-height:140px;
}
.titlebar {
  background:black;padding:3px;border-bottom:2px solid currentColor;
  cursor:move;font-size:14px;
}
.win-content {padding:6px;overflow:auto;}
.app-icon {
  width:64px;height:64px;border:2px solid currentColor;
  text-align:center;cursor:pointer;
  font-size:11px;margin:5px;display:flex;
  flex-direction:column;justify-content:center;
}
#iconArea {display:flex;flex-wrap:wrap;padding:5px;}
.hide {display:none;}
button {
  background:black;color:currentColor;border:2px solid currentColor;
  cursor:pointer;margin-top:4px;
}
input,textarea {
  background:black;color:currentColor;border:2px solid currentColor;
}
</style>
</head>
<body>

<!-- BOOT -->
<div id="boot" class="boot-screen">
  <div>BOOTING Retro Pixel OS...</div><br>
  <div>Choose Device Type:</div><br>
  <button class="boot-btn" onclick="boot('pc')">üñ•Ô∏è PC MODE</button>
  <button class="boot-btn" onclick="boot('mobile')">üì± MOBILE MODE</button>
</div>

<!-- DESKTOP -->
<div id="desktop">
  <div id="iconArea">
    <div class="app-icon" onclick="openWin('Paint')">üé®<br>Paint</div>
    <div class="app-icon" onclick="openWin('Note')">üìù<br>Notes</div>
    <div class="app-icon" onclick="openWin('Calc')">üßÆ<br>Calc</div>
    <div class="app-icon" onclick="openWin('Browser')">üåê<br>Web</div>
    <div class="app-icon" onclick="openWin('CMD')">üíª<br>CMD</div>
    <div class="app-icon" onclick="openWin('Settings')">‚öôÔ∏è<br>Settings</div>
  </div>

  <div class="taskbar">
    <button onclick="toggleStart()">Start</button>
    <div id="startMenu" class="hide" style="background:black;border:2px solid currentColor;position:absolute;bottom:40px;padding:5px;">
      <div onclick="openWin('Paint')">Paint</div>
      <div onclick="openWin('Note')">Notes</div>
      <div onclick="openWin('Calc')">Calculator</div>
      <div onclick="openWin('Browser')">Browser</div>
      <div onclick="openWin('CMD')">CMD</div>
      <div onclick="openWin('Settings')">Settings</div>
    </div>
  </div>
</div>

<script>
let currentColor="#00ff00";
let mobileMode=false;

function boot(mode){
  mobileMode = mode==="mobile";
  document.getElementById("boot").style.display="none";
  document.getElementById("desktop").style.display="block";
  if(mobileMode){
    document.querySelectorAll('.app-icon').forEach(i=>{
      i.style.width="48px";i.style.height="48px";i.style.fontSize="9px";
    });
  }
}

// Start Menu toggle
function toggleStart(){
  document.getElementById("startMenu").classList.toggle("hide");
}

// WINDOW MANAGEMENT
function openWin(app){
  const win=document.createElement("div");
  win.className="window";
  win.style.left="50px";win.style.top="50px";
  win.innerHTML=`
    <div class="titlebar" onmousedown="drag(event,this.parentElement)">${app}</div>
    <div class="win-content">${appContent(app)}</div>
  `;
  document.body.appendChild(win);
}

function appContent(a){
  if(a==="Paint")
    return `
      <input type="color" id="paintColor" value="#00ff00">
      <select id="brushSize">
         <option>2</option><option>5</option><option>10</option><option>20</option>
      </select>
      <button onclick="setTool('brush')">Brush</button>
      <button onclick="setTool('bucket')">Bucket</button>
      <button onclick="clearCanvas()">Clear</button><br>
      <canvas id="paintCanvas" style="background:black;border:2px solid currentColor;width:100%;height:75vh;"></canvas>
    `;
  if(a==="Note")
    return `<textarea style="width:100%;height:75vh;"></textarea>`;
  if(a==="Calc")
    return `
      <input id="calcDisplay" style="width:100%;"><br>
      <button onclick="press('1')">1</button>
      <button onclick="press('2')">2</button>
      <button onclick="press('3')">3</button>
      <button onclick="press('+')">+</button><br>
      <button onclick="press('4')">4</button>
      <button onclick="press('5')">5</button>
      <button onclick="press('6')">6</button>
      <button onclick="press('-')">-</button><br>
      <button onclick="press('7')">7</button>
      <button onclick="press('8')">8</button>
      <button onclick="press('9')">9</button>
      <button onclick="press('*')">*</button><br>
      <button onclick="press('0')">0</button>
      <button onclick="press('/')">/</button>
      <button onclick="press('=')">=</button>
    `;
  if(a==="Browser")
    return `<input id="q"><button onclick="search()">Search Web</button>`;
  if(a==="CMD")
    return `<textarea id="cmd" style="width:100%;height:70vh;"></textarea><br><button onclick="runCMD()">Run</button>`;
  if(a==="Settings")
    return `UI Color <input type="color" onchange="changeColor(this.value)" value="${currentColor}">`;
  return "";
}

// DRAGGING
function drag(e,win){
  let x=e.clientX,y=e.clientY;
  document.onmousemove=(ev)=>{
    let dx=ev.clientX-x, dy=ev.clientY-y;
    win.style.left = (win.offsetLeft+dx)+"px";
    win.style.top  = (win.offsetTop+dy)+"px";
    x=ev.clientX;y=ev.clientY;
  };
  document.onmouseup=()=>document.onmousemove=null;
}

// COLOR FIX
function changeColor(c){
  currentColor=c;
  document.querySelectorAll("*").forEach(el=>{
    el.style.color=c;
    el.style.borderColor=c;
  });
}

// Browser
function search(){
  let q=document.getElementById("q").value;
  if(q) window.open("https://www.google.com/search?q="+encodeURIComponent(q));
}

// Calc
let calcVal="";
function press(c){
  if(c==="="){
    try{calcVal=eval(calcVal)}catch{calcVal="ERR"}
    document.getElementById("calcDisplay").value=calcVal;calcVal="";
  } else {
    calcVal+=c;document.getElementById("calcDisplay").value=calcVal;
  }
}

// Paint
let tool="brush", paintCanvas, paintCtx;
function setTool(t){ tool=t; }
function clearCanvas(){ paintCtx.fillRect(0,0,paintCanvas.width,paintCanvas.height); }

function runCMD(){ alert("CMD executes dummy text only in this build."); }

document.addEventListener("click",e=>{
  if(e.target.id==="paintCanvas"){
    paintCanvas=e.target; paintCtx=paintCanvas.getContext("2d");
    paintCtx.strokeStyle=currentColor; paintCtx.lineWidth=5;
  }
});
</script>
</body>
</html>

